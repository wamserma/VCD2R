context("VCD setup and teardown")

test_that("creating a VCD object works",{
          vcd<-VCDFile()
          expect_true(is.na(vcd$filename))
          expect_true(is.na(vcd$date))
          expect_true(is.na(vcd$version))
          expect_true(is.na(vcd$timescale))
          expect_true(is.na(vcd$hierarchy))
          expect_equal(vcd$dumpstart,c(0,0))
          expect_s3_class(vcd,"VCDFile")
          rm(vcd)

          expect_warning(vcd<-VCDFile("dummy.vcd",F),"File does not exist: dummy.vcd")
          expect_true(is.na(vcd$filename))
          expect_true(is.na(vcd$date))
          expect_true(is.na(vcd$version))
          expect_true(is.na(vcd$timescale))
          expect_true(is.na(vcd$hierarchy))
          expect_equal(vcd$dumpstart,c(0,0))
          expect_s3_class(vcd,"VCDFile")
          rm(vcd)

          expect_warning(vcd<-VCDFile("dummy.vcd",F),"File does not exist: dummy.vcd")
          expect_true(is.na(vcd$filename))
          expect_true(is.na(vcd$date))
          expect_true(is.na(vcd$version))
          expect_true(is.na(vcd$timescale))
          expect_true(is.na(vcd$hierarchy))
          expect_equal(vcd$dumpstart,c(0,0))
          expect_s3_class(vcd,"VCDFile")
          rm(vcd)

          vcd<-VCDFile("wikipedia.vcd",F)
          expect_equal(vcd$filename,"wikipedia.vcd")
          expect_true(is.na(vcd$date))
          expect_true(is.na(vcd$version))
          expect_true(is.na(vcd$timescale))
          expect_true(is.na(vcd$hierarchy))
          expect_equal(vcd$dumpstart,c(0,0))
          expect_s3_class(vcd,"VCDFile")
          rm(vcd)

          vcd<-VCDFile("wikipedia.vcd")
          expect_equal(vcd$filename,"wikipedia.vcd")
          expect_equal(vcd$date,"Date text. For example: November 11, 2009.")
          expect_equal(vcd$version,"VCD generator tool version info text.")
          expect_equal(vcd$timescale,c(scale="1",unit="ps"))
          load("hierref1.RData")
          expect_equal(data.tree::ToListSimple(vcd$hierarchy),ref)
          expect_equal(vcd$dumpstart,c(0,483))
          expect_s3_class(vcd,"VCDFile")

})

test_that("printing an empty VCD object works",{
  expect_output(print(VCDFile()),"file: NA\ngenerated by: NA\ndump time: NA\ntimescale: NA\nnumber of signals: 0")
})

test_that("printing a simple VCD object works",{
  expect_output(print(VCDFile("wikipedia.vcd")),"file: wikipedia.vcd\ngenerated by: VCD generator tool version info text.\ndump time: Date text. For example: November 11, 2009.\ntimescale: 1 ps\nnumber of signals: 14") #nolint (line length)
})
